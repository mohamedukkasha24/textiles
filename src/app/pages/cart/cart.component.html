<div class="container py-5">
  <h2 class="fw-bold mb-4">Your Cart</h2>

  <ng-container *ngIf="cartItems$ | async as items">
    <div *ngIf="items.length; else emptyCart" class="row g-4">
      <!-- Cart Items -->
      <div class="col-lg-8">
        <div *ngFor="let item of items" class="card shadow-sm mb-3">
          <div class="row g-0 align-items-center p-3">
            <!-- Product Image -->
            <div class="col-4 col-md-3">
              <img
                [src]="item.product.images[0]"
                class="img-fluid rounded"
                alt="{{ item.product.name }}"
              />
            </div>

            <!-- Product Info -->
            <div class="col-8 col-md-5 ps-3">
              <h6 class="fw-semibold mb-1">{{ item.product.name }}</h6>
              <small class="text-muted">{{ item.product.category }}</small>
              <p class="small text-muted mt-2 d-none d-md-block">
                {{ item.product.description }}
              </p>
            </div>

            <!-- Quantity -->
            <div
              class="col-6 col-md-2 mt-3 mt-md-0 d-flex justify-content-center align-items-center"
            >
              <div class="btn-group btn-group-sm" role="group">
                <button
                  class="btn btn-outline-secondary"
                  (click)="decreaseQty(item)"
                >
                  -
                </button>
                <button class="btn btn-light" disabled>{{ item.qty }}</button>
                <button
                  class="btn btn-outline-secondary"
                  (click)="increaseQty(item)"
                >
                  +
                </button>
              </div>
            </div>

            <!-- Price + Remove -->
            <div class="col-6 col-md-2 mt-3 mt-md-0 text-end">
              <div class="fw-semibold">
                ₹ {{ item.product.price * item.qty }}
              </div>
              <button
                class="btn btn-outline-danger btn-sm mt-2"
                (click)="remove(item)"
              >
                <i class="bi bi-trash"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Order Summary -->
      <div class="col-lg-4">
        <div class="card shadow-sm p-4">
          <h5 class="fw-bold mb-3">Order Summary</h5>
          <div class="d-flex justify-content-between mb-2">
            <span>Subtotal</span>
            <span class="fw-semibold">₹ {{ cart.total() }}</span>
          </div>
          <div class="d-flex justify-content-between mb-2">
            <span>Shipping</span>
            <span class="fw-semibold">₹ 40</span>
          </div>
          <hr />
          <div class="d-flex justify-content-between fs-5 fw-bold">
            <span>Total</span>
            <span>₹ {{ cart.total() + 100 }}</span>
          </div>
          <button
            class="btn btn-success w-100 mt-4"
            [disabled]="(cartItems$ | async)?.length === 0"
            (click)="proceedToCheckout()"
          >
            <i class="bi bi-credit-card"></i> Proceed to Checkout
          </button>
        </div>
      </div>
    </div>

    <!-- Empty Cart -->
    <ng-template #emptyCart>
      <div class="text-center py-5">
        <i class="bi bi-bag-x fs-1 text-muted"></i>
        <p class="fs-5">Your cart is currently empty.</p>
        <a routerLink="/products" class="btn btn-success">Shop Now</a>
      </div>
    </ng-template>
  </ng-container>
</div>
