<div class="container py-5">
    <h2 class="fw-bold mb-4">Your Cart</h2>

    <ng-container *ngIf="cartItems$ | async as items">
        <div *ngIf="items.length; else emptyCart">
            <table class="table align-middle">
                <thead class="table-light">
                    <tr>
                        <th>Product</th>
                        <th>Price</th>
                        <th style="width:150px;">Qty</th>
                        <th>Total</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of items">
                        <td>
                            <div class="d-flex align-items-center gap-3">
                                <img [src]="item.product.images[0]" width="60" class="rounded shadow-sm">
                                <div>
                                    <h6 class="mb-1">{{ item.product.name }}</h6>
                                    <small class="text-muted">{{ item.product.category }}</small>
                                </div>
                            </div>
                        </td>
                        <td>₹ {{ item.product.price }}</td>
                        <td>
                            <div class="btn-group">
                                <button class="btn btn-outline-secondary" (click)="decreaseQty(item)">-</button>
                                <button class="btn btn-light" disabled>{{ item.qty }}</button>
                                <button class="btn btn-outline-secondary" (click)="increaseQty(item)">+</button>
                            </div>
                        </td>
                        <td>₹ {{ item.product.price * item.qty }}</td>
                        <td>
                            <button class="btn btn-outline-danger btn-sm" (click)="remove(item)">
                                <i class="bi bi-trash"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>

            <div class="text-end mt-4">
                <h4>Total: <span class="text-success">₹ {{ cart.total() }}</span></h4>
                <button class="btn btn-success btn-lg mt-3">
                    <i class="bi bi-credit-card"></i> Checkout
                </button>
            </div>
        </div>

        <ng-template #emptyCart>
            <div class="text-center py-5">
                <i class="bi bi-bag-x fs-1 text-muted"></i>
                <p>Your cart is empty.</p>
                <a routerLink="/products" class="btn btn-success">Shop Now</a>
            </div>
        </ng-template>
    </ng-container>
</div>